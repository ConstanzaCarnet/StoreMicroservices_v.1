#aqui es donde configuraremos todos los microservicios de la app
version: '3.9'

services:
  product-service:
    container_name: product-service
    build:
      context: ./ProductService
      dockerfile: Dockerfile
    ports:
      - "8001:8080"
    depends_on:
      - product-db
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ConnectionStrings__ProductDatabase: >
        Server=product-db;
        Database=ProductDb;
        User Id=sa;
        Password=Your_password123;
        TrustServerCertificate=True;

  product-db:
    container_name: product-db
    image: mcr.microsoft.com/mssql/server:2022-latest
    environment:
      SA_PASSWORD: "Your_password123"
      ACCEPT_EULA: "Y"
    volumes:
      - product-db-data:/var/opt/mssql

  order-service:
    container_name: order-service
    build:
      context: ./OrderService
      dockerfile: Dockerfile
    ports:
      - "8002:8080"
    depends_on:
      - order-db
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ConnectionStrings__OrderDatabase: >
        Server=order-db,1433;
        Database=OrderDb;
        User Id=sa;
        Password=Your_password123;
        TrustServerCertificate=True;

  order-db:
    container_name: order-db
    image: mcr.microsoft.com/mssql/server:2022-latest
    environment:
      SA_PASSWORD: "Your_password123"
      ACCEPT_EULA: "Y"
    volumes:
      - order-db-data:/var/opt/mssql

volumes:
  product-db-data:
  order-db-data:
